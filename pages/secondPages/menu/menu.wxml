<!-- pages/drinkDetail/drinkDetail.wxml -->
<view class="container bg-gray-50 min-h-screen">
  <!-- 返回按钮和标题 -->
  <view class="bg-white shadow-sm fixed top-0 left-0 right-0 z-10" style="height: {{navInfo.navBarHeight}}px; padding-top: {{navInfo.statusBarHeight}}px;">
    <!-- 胶囊按钮占位区域 -->
    <view class="capsule-placeholder" style="position: absolute; right: 10px; height: {{navInfo.menuButtonHeight}}px; margin-top: {{navInfo.menuButtonTop - navInfo.statusBarHeight}}px;"></view>

      <view class="absolute text-xl menu-chevron-left " style="left: 6px; top: {{navInfo.statusBarHeight + navInfo.menuButtonTop - navInfo.statusBarHeight}}px;  height: {{navInfo.menuButtonHeight}}px; line-height: {{navInfo.menuButtonHeight}}px; text-align: center;" bindtap="navigateBack">
        <t-icon name="chevron-left" ></t-icon>
        <text >{{drinkInfo.name}}</text>
      </view>
  </view>

  <!-- 饮品图片 -->
  <view class="drink-image" style="padding-top: {{navInfo.navBarHeight}}px;">
    <image class="w-full w-full" src="{{drinkInfo.image || 'https://picsum.photos/400/200?food=default'}}" mode="widthFix"></image>
  </view>

  <!-- 饮品名称和描述 -->
  <view class="header px-4 py-4 bg-white mt-2">
    <text class="name text-2xl font-bold">{{drinkInfo.name}}</text>
    <text class="desc text-gray-500 mt-2 text-sm">{{drinkInfo.desc}}</text>
  </view>

  <!-- 甜度说明 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.sweetness}}">
    <text class="section-title font-bold text-gray-800">{{drinkInfo.sweetness}}</text>
    <text class="note text-gray-500 text-sm mt-1">{{drinkInfo.sweetnessDesc}}</text>
  </view>

  <!-- 杯型选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.sizeOptions && drinkInfo.sizeOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">杯型</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.sizeOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedSize === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectSize" data-size="{{item.value}}" data-price="{{item.price}}">
            <text class="block text-sm">{{item.text}}</text>
            <text class="block text-xs mt-1" wx:if="{{item.price > 0}}">+¥{{item.price}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 主题杯选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.themeOptions && drinkInfo.themeOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">主题杯可选</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.themeOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedtheme === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTheme" data-theme="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 口味选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.tasteOptions && drinkInfo.tasteOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">口味</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.tasteOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedtaste === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTaste" data-taste="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 甜度选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.sweetOptions && drinkInfo.sweetOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">甜度</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.sweetOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedsweet === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectSweet" data-sweet="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 温度选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.tempOptions && drinkInfo.tempOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">温度</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.tempOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedTemp === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTemp" data-temp="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 茶底选择 -->
  <view class="section px-4 py-3 bg-white mt-2" wx:if="{{drinkInfo.teaOptions && drinkInfo.teaOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">茶底</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.teaOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedTea === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTea" data-tea="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 加料选择 -->
  <view class="section px-4 py-3 bg-white mt-2 mb-24" wx:if="{{drinkInfo.toppingOptions && drinkInfo.toppingOptions.length > 0}}">
    <text class="section-title font-bold text-gray-800">加料</text>
    <view class="options flex flex-wrap mt-2 -mx-1">
      <block wx:for="{{drinkInfo.toppingOptions}}" wx:key="value">
        <view class="option w-1/3 text-center py-3 my-1 px-1">
          <view class="border border-gray-300 rounded-lg py-2 {{selectedTopping === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTopping" data-topping="{{item.value}}" data-price="{{item.price}}">
            <text class="block text-sm">{{item.text}}</text>
            <text class="block text-xs mt-1" wx:if="{{item.price > 0}}">+¥{{item.price}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <view class="footer fixed bottom-0 left-0 right-0 bg-white shadow-lg p-4 flex items-center justify-between">
    <view class="price-container">
      <text class="price text-xl font-bold text-red-500">¥{{totalPrice * quantity}}</text>
    </view>
    <text class="selection text-sm text-gray-500 max-w-40 truncate">{{currentSelection}}</text>
    <view class="section">
      <view class="cart-actions flex items-center">
        <button class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-full text-gray-600" bindtap="decreaseQuantity">-</button>
        <text class="mx-3 text-lg font-medium">{{quantity}}</text>
        <button class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-full text-gray-600" bindtap="increaseQuantity">+</button>
      </view>
    </view>
    <button class="add-btn bg-red-500 text-white px-6 py-2 rounded-full font-medium" bindtap="addToCart">加入购物车</button>
  </view>
</view>