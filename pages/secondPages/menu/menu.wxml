<!-- pages/drinkDetail/drinkDetail.wxml -->
<view class="container min-h-screen bg-gray-50">
  <!-- 返回按钮和标题 -->
  <view class="fixed top-0 left-0 right-0 z-10 bg-white shadow-sm" style="height: {{navInfo.navBarHeight}}px; padding-top: {{navInfo.statusBarHeight}}px;">
    <!-- 胶囊按钮占位区域 -->
    <view class="capsule-placeholder" style="position: absolute; right: 10px; height: {{navInfo.menuButtonHeight}}px; margin-top: {{navInfo.menuButtonTop - navInfo.statusBarHeight}}px;"></view>

    <view class="absolute text-xl menu-chevron-left" style="left: 6px; top: {{navInfo.statusBarHeight + navInfo.menuButtonTop - navInfo.statusBarHeight}}px; height: {{navInfo.menuButtonHeight}}px; line-height: {{navInfo.menuButtonHeight}}px; text-align: center;" bindtap="navigateBack">
      <t-icon name="chevron-left"></t-icon>
      <text>{{drinkInfo.name}}</text>
    </view>
  </view>

  <!-- 饮品图片 -->
  <view class="drink-image" style="padding-top: {{navInfo.navBarHeight}}px;">
    <image class="w-full" src="{{drinkInfo.image || 'https://picsum.photos/400/200?food=default'}}" mode="widthFix"></image>
  </view>

  <!-- 饮品名称和描述 -->
  <view class="px-4 py-4 mt-2 bg-white rounded-lg shadow-sm header">
    <text class="text-2xl font-bold name">{{drinkInfo.name}}</text>
    <text class="mt-2 text-sm text-gray-500 desc">{{drinkInfo.desc}}</text>
  </view>

  <!-- 甜度说明 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.sweetness}}">
    <text class="font-bold text-gray-800 section-title">{{drinkInfo.sweetness}}</text>
    <text class="mt-1 text-sm text-gray-500 note">{{drinkInfo.sweetnessDesc}}</text>
  </view>

  <!-- 杯型选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.sizeOptions && drinkInfo.sizeOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">杯型</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.sizeOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedSize === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectSize" data-size="{{item.value}}" data-price="{{item.price}}">
            <text class="block text-sm">{{item.text}}</text>
            <text class="block mt-1 text-xs" wx:if="{{item.price > 0}}">+¥{{item.price}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 主题杯选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.themeOptions && drinkInfo.themeOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">主题杯可选</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.themeOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedtheme === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTheme" data-theme="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 口味选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.tasteOptions && drinkInfo.tasteOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">口味</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.tasteOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedtaste === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTaste" data-taste="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 甜度选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.sweetOptions && drinkInfo.sweetOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">甜度</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.sweetOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedsweet === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectSweet" data-sweet="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 温度选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.tempOptions && drinkInfo.tempOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">温度</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.tempOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedTemp === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTemp" data-temp="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 茶底选择 -->
  <view class="px-4 py-3 mt-2 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.teaOptions && drinkInfo.teaOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">茶底</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.teaOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedTea === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTea" data-tea="{{item.value}}">
            <text class="block text-sm">{{item.text}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 加料选择 -->
  <view class="px-4 py-3 mt-2 mb-24 bg-white rounded-lg shadow-sm section" wx:if="{{drinkInfo.toppingOptions && drinkInfo.toppingOptions.length > 0}}">
    <text class="font-bold text-gray-800 section-title">加料</text>
    <view class="flex flex-wrap mt-2 -mx-1 options">
      <block wx:for="{{drinkInfo.toppingOptions}}" wx:key="value">
        <view class="w-33 px-1 py-3 my-1 text-center option">
          <view class="py-2 border-2 border-gray-300 rounded-xl {{selectedTopping === item.value ? 'border-green-500 bg-green-50 text-green-600' : 'bg-white'}}" bindtap="selectTopping" data-topping="{{item.value}}" data-price="{{item.price}}">
            <text class="block text-sm">{{item.text}}</text>
            <text class="block mt-1 text-xs" wx:if="{{item.price > 0}}">+¥{{item.price}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <view class="fixed bottom-0 left-0 right-0 flex items-center justify-between p-4 bg-white shadow-lg footer">
    <view class="price-container">
      <text class="text-xl font-bold text-red-500 price">¥{{totalPrice * quantity}}</text>
    </view>
    <text class="max-w-40 text-sm text-gray-500 truncate selection">{{currentSelection}}</text>
    <view class="section">
      <view class="flex items-center cart-actions">
        <button class="flex items-center justify-center w-8 h-8 text-gray-600 border border-gray-300 rounded-full" bindtap="decreaseQuantity">-</button>
        <text class="mx-3 text-lg font-medium">{{quantity}}</text>
        <button class="flex items-center justify-center w-8 h-8 text-gray-600 border border-gray-300 rounded-full" bindtap="increaseQuantity">+</button>
      </view>
    </view>
    <button class="px-6 py-2 font-medium text-white bg-red-500 rounded-full add-btn" bindtap="addToCart">加入购物车</button>
  </view>
</view>